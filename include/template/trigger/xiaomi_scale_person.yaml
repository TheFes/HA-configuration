- trigger:
    - platform: state
      entity_id: sensor.mi_body_composition_scale_3496_mass
      not_to: "unavailable"
      for:
        seconds: 20
      variables: &var
        name: >
          {%- if states('input_number.weight_martijn_min') | float < trigger.to_state.state | float <= states('input_number.weight_martijn_max') | float %}
            martijn
          {%- elif states('input_number.weight_marleen_min') | float < trigger.to_state.state | float <= states('input_number.weight_marleen_max') | float %}
            marleen
          {%- else %}
            no update
          {%- endif %}
  sensor:
    - unique_id: 8523c401-c2a0-48d9-9669-3fdbe51ba8c4
      name: Weight Martijn
      unit_of_measurement: kg
      state_class: measurement
      icon: mdi:weight-kilogram
      state: &weight >
        {{ trigger.to_state.state if name in this.entity_id else this.state }}
    - unique_id: 3948030c-3fe0-4be8-8851-87e6a198e334
      name: Weight Marleen
      icon: mdi:weight-kilogram
      state_class: measurement
      unit_of_measurement: kg
      state: *weight
    - unique_id: 5257e56d-f8bc-49c3-b46a-46f47a4065e0
      name: Impedance Martijn
      unit_of_measurement: ohm
      state_class: measurement
      icon: mdi:omega
      state: &imp >
        {%- set i = 'sensor.mi_body_composition_scale_3496_impedance' %}
        {%- set valid = states(i) | is_number and now() - states[i].last_changed < timedelta(seconds=30) %}
        {{ states(i) if name in this.entity_id and valid else this.state }}
    - unique_id: 3aa91cd3-c2b2-4910-be24-55f1fd379213
      name: Impedance Marleen
      unit_of_measurement: ohm
      state_class: measurement
      icon: mdi:omega
      state: *imp
