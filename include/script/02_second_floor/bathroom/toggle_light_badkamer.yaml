badkamer_zolder_toggle:
  alias: "F2B - Actions for template light bathroom 2nd floor"
  icon: "mdi:light-recessed"
  mode: restart
  sequence:
    - alias: "On"
      if: "{{ action == 'on' }}"
      then:
        - alias: "Light off no transition active?"
          choose:
            - conditions:
                - alias: "Not yet dimmed?"
                  condition: state
                  entity_id: input_boolean.dimmed_badkamer_zolder
                  state: "off"
              sequence:
                - alias: "Time of day?"
                  choose:
                    - alias: "Night"
                      conditions:
                        - condition: time
                          after: "22:00"
                          before: "07:00"
                      sequence:
                        - alias: "Turn on light dimmed"
                          service: light.turn_on
                          target:
                            entity_id: light.badkamer_zolder
                          data:
                            brightness: 25
                        - alias: "Turn on light dimmed"
                          service: light.turn_on
                          target:
                            entity_id: light.badkamer_zolder
                          data:
                            color_temp_kelvin: 2000
                        - alias: "Turn on input_boolean"
                          service: input_boolean.turn_on
                          target:
                            entity_id: input_boolean.dimmed_badkamer_zolder
                  default:
                    - alias: "Light on 100% during daytime"
                      service: light.turn_on
                      target:
                        entity_id: light.badkamer_zolder
                      data:
                        brightness: 255
                        color_temp_kelvin: 6535
                    - alias: "Turn on input_boolean"
                      service: input_boolean.turn_on
                      target:
                        entity_id: input_boolean.dimmed_badkamer_zolder
          default:
            - alias: "Light on with current setting if it has already been turned on before"
              service: light.turn_on
              target:
                entity_id: light.badkamer_zolder
      else:
        - alias: "Light off"
          service: light.turn_off
          target:
            entity_id: light.badkamer_zolder
