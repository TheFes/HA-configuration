id: 5119f754-7461-4fcb-be4b-1380e656a450
alias: "F2L - Actions with Shelly Zolder"
mode: parallel
max_exceeded: silent
trigger:
  - platform: event
    event_type: esphome.button_pressed
    event_data:
      device: Zolder
  - platform: event
    event_type: esphome.button_pressed
    event_data:
      device: Wasmachinehoek
condition:
  - "{{ is_state('switch.zolder_shelly_control_light', 'off') if trigger.event.data.device == 'Zolder' else true }}"
action:
  - variables:
      main: light.{{ trigger.event.data.device | lower }}_template
      group: light.groep_{{ trigger.event.data.device | lower }}
  - alias: "Click type?"
    choose:
      - conditions:
          - alias: "Short?"
            condition: template
            value_template: "{{ trigger.event.data.click_type == 'short' }}"
        sequence:
          - alias: Toggle Overloop group
            service: light.toggle
            data:
              entity_id: light.groep_overloop_zolder
      - conditions:
          - alias: "Double?"
            condition: template
            value_template: "{{ trigger.event.data.click_type == 'double' }}"
        sequence:
          - alias: Set overloop group to 100%
            service: light.turn_on
            data:
              entity_id: light.groep_overloop_zolder
              brightness: 255
      - conditions:
          - alias: "Long"
            condition: template
            value_template: "{{ trigger.event.data.click_type == 'long' }}"
        sequence:
          - alias: Turn of all lights on 2nd floor and attic
            service: light.turn_off
            data:
              entity_id: light.groep_zolder
