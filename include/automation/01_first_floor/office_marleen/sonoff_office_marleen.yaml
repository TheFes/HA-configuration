id: 72fc0fda-dd3f-4c4e-8846-5115612e30e6
alias: "Actions with wall button office Marleen"
mode: parallel
max_exceeded: silent
triggers:
  - trigger: state
    entity_id: event.shelly1_werkkamer_marleen_shelly1_werkkamer_marleen
    not_from: unavailable
actions:
  - variables:
      main: light.werkkamer_marleen_template
      group: light.groep_werkkamer_marleen
  - alias: "Click type?"
    choose:
      - conditions:
          - alias: "Short?"
            condition: template
            value_template: "{{ trigger.to_state.attributes.event_type == 'single_press' }}"
        sequence:
          - if: "{{ is_state(main, 'on') }}"
            then:
              - alias: "Turn off main light"
                action: light.turn_off
                target:
                  entity_id: "{{ main }}"
            else:
              - alias: "Turn on main light"
                action: light.turn_on
                target:
                  entity_id: "{{ main }}"
      - conditions:
          - alias: "Double?"
            condition: template
            value_template: "{{ trigger.to_state.attributes.event_type == 'double_press' }}"
        sequence:
          - alias: "Light to 100% brightness"
            action: light.turn_on
            target:
              entity_id: "{{ main }}"
            data:
              brightness: 255
      - conditions:
          - alias: "Long"
            condition: template
            value_template: "{{ trigger.to_state.attributes.event_type == 'long_press' }}"
        sequence:
          - alias: "Turn on light with low brightness"
            action: light.turn_on
            target:
              entity_id: "{{ main }}"
            data:
              brightness_pct:
      - conditions:
          - alias: "Single Long"
            condition: template
            value_template: "{{ trigger.to_state.attributes.event_type == 'single_long_press' }}"
        sequence:
          - if:
              - condition: state
                entity_id: switch.light_werkkamer_marleen_dim_down
                state: "on"
            then:
              - action: button.press
                target:
                  entity_id: button.light_werkkamer_marleen_dim_down
            else:
              - action: button.press
                target:
                  entity_id: button.light_werkkamer_marleen_dim_down
      - conditions:
          - alias: "Release"
            condition: template
            value_template: "{{ trigger.to_state.attributes.event_type == 'single_long_press' }}"
        sequence:
          - action: button.press
            target:
              entity_id: button.light_werkkamer_marleen_dim_stop
